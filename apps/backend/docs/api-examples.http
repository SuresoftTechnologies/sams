### SureSoft SAMS - Authentication API Examples
### Base URL
@baseUrl = http://localhost:8000/api/v1
@email = admin@suresoft.com
@password = admin123!

###############################################################################
# 1. Register New User
###############################################################################

### Register a new user
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "email": "john.doe@suresoft.com",
  "password": "SecurePass123!",
  "name": "John Doe",
  "department": "IT"
}

###############################################################################
# 2. Login
###############################################################################

### Login with credentials
# @name login
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "{{password}}"
}

### Extract tokens from login response
@accessToken = {{login.response.body.access_token}}
@refreshToken = {{login.response.body.refresh_token}}

###############################################################################
# 3. Get Current User Info
###############################################################################

### Get current authenticated user
GET {{baseUrl}}/auth/me
Authorization: Bearer {{accessToken}}

###############################################################################
# 4. Change Password
###############################################################################

### Change password for current user
PUT {{baseUrl}}/auth/change-password
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "old_password": "{{password}}",
  "new_password": "NewSecurePass456!"
}

###############################################################################
# 5. Refresh Token
###############################################################################

### Refresh access token using refresh token
POST {{baseUrl}}/auth/refresh
Content-Type: application/json

{
  "refresh_token": "{{refreshToken}}"
}

###############################################################################
# 6. Logout
###############################################################################

### Logout (invalidate session)
POST {{baseUrl}}/auth/logout
Authorization: Bearer {{accessToken}}

###############################################################################
# 7. Test Protected Routes with Different Roles
###############################################################################

### Test with invalid token (should return 401)
GET {{baseUrl}}/auth/me
Authorization: Bearer invalid_token_here

### Test without authorization header (should return 403)
GET {{baseUrl}}/auth/me

###############################################################################
# 8. Example User Management (if implemented)
###############################################################################

### Get all users (admin only)
GET {{baseUrl}}/users
Authorization: Bearer {{accessToken}}

### Get user by ID
GET {{baseUrl}}/users/550e8400-e29b-41d4-a716-446655440000
Authorization: Bearer {{accessToken}}

### Create new user (admin only)
POST {{baseUrl}}/users
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "email": "new.user@suresoft.com",
  "password": "SecurePass123!",
  "name": "New User",
  "role": "employee",
  "department": "Sales"
}

### Update user
PUT {{baseUrl}}/users/550e8400-e29b-41d4-a716-446655440000
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "name": "Updated Name",
  "department": "Engineering"
}

### Deactivate user (admin only)
DELETE {{baseUrl}}/users/550e8400-e29b-41d4-a716-446655440000
Authorization: Bearer {{accessToken}}

###############################################################################
# Testing Different User Roles
###############################################################################

### Login as Manager
# @name loginManager
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "manager@suresoft.com",
  "password": "manager123!"
}

@managerToken = {{loginManager.response.body.access_token}}

### Login as Employee
# @name loginEmployee
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "employee@suresoft.com",
  "password": "employee123!"
}

@employeeToken = {{loginEmployee.response.body.access_token}}

### Test manager access
GET {{baseUrl}}/auth/me
Authorization: Bearer {{managerToken}}

### Test employee access
GET {{baseUrl}}/auth/me
Authorization: Bearer {{employeeToken}}

###############################################################################
# 9. Email API Examples
###############################################################################

### Send basic text email
POST {{baseUrl}}/email/send
Content-Type: application/json

{
  "to": ["recipient@example.com"],
  "subject": "테스트 이메일",
  "body": "안녕하세요. 이것은 테스트 이메일입니다."
}

### Send HTML email
POST {{baseUrl}}/email/send
Content-Type: application/json

{
  "to": ["recipient@example.com"],
  "subject": "HTML 이메일 테스트",
  "body": "텍스트 버전의 내용입니다.",
  "html_body": "<h1>환영합니다!</h1><p>이것은 <strong>HTML</strong> 형식의 이메일입니다.</p><p>자산 관리 시스템에서 보낸 이메일입니다.</p>"
}

### Send email with CC and BCC
POST {{baseUrl}}/email/send
Content-Type: application/json

{
  "to": ["recipient@example.com"],
  "subject": "팀 공지사항",
  "body": "중요한 공지사항입니다.\n\n팀 전체에 전달되는 메시지입니다.",
  "cc": ["manager@example.com"],
  "bcc": ["archive@example.com"]
}

### Send email to multiple recipients
POST {{baseUrl}}/email/send
Content-Type: application/json

{
  "to": [
    "user1@example.com",
    "user2@example.com",
    "user3@example.com"
  ],
  "subject": "다중 수신자 테스트",
  "body": "여러 명에게 동시에 전송되는 이메일입니다."
}

### Send formatted notification email
POST {{baseUrl}}/email/send
Content-Type: application/json

{
  "to": ["admin@suresoft.com"],
  "subject": "[자산관리] 새로운 자산이 등록되었습니다",
  "body": "새로운 자산이 등록되었습니다.\n\n자산명: 노트북\n자산코드: ASSET-2024-001\n담당자: 홍길동",
  "html_body": "<h2>새로운 자산 등록 알림</h2><table border='1' cellpadding='10'><tr><th>항목</th><th>내용</th></tr><tr><td>자산명</td><td>노트북</td></tr><tr><td>자산코드</td><td>ASSET-2024-001</td></tr><tr><td>담당자</td><td>홍길동</td></tr></table>"
}